---
title: Create a blog with MDX and Next.js
slug: next-mdx-blog
---

# Create a blog with MDX and Next.js

### Scaffold new Next.js project with hello-world starter:
1. `yarn create next-app --example hello-world my-blog`
2. `cd my-blog`


### Add support for MDX with `next-mdx-enhanced` plugin
1. Add MDX Enhanced plugin: `yarn add next-mdx-enhanced`
2. Add `extra-watch-webpack-plugin` which adds support for hot reloading changes in frontmatter: `yarn add extra-watch-webpack-plugin`
3. Create `next.config.js` file in root directory: `touch next.config.js` and add following code:
```js
// next.config.js
const withMdxEnhanced = require('next-mdx-enhanced')
const ExtraWatchWebpackPlugin = require('extra-watch-webpack-plugin')
const path = require('path')

module.exports = withMdxEnhanced({
  layoutPath: 'components/layouts',
  defaultLayout: true,
  fileExtensions: ['mdx'],
  remarkPlugins: [],
  rehypePlugins: [],
  extendFrontMatter: {
    process: (mdxContent, frontMatter) => {},
    phase: 'prebuild|loader|both',
  },
})({
  // enable hot reloading for MDX frontmatter
  webpack: config => {
    config.plugins.push(
      new ExtraWatchWebpackPlugin({
        dirs: [path.join(config.context, 'pages')],
      })
    )
    return config
  },
})
```


### Create a layout component
Create `components/layouts/index.js` and add following code:
```js
// components/layouts/index.js
export default frontmatter => {
  return ({children: content}) => {
    return (
        <article>
          <h1>{frontmatter.title}</h1>
          {content}
        </article>
    )
  }
}
```


### Add your first post
Create `post.mdx` file in `pages/blog/` directory.
```md
---
title: Post
---

First post
```


### Test it out

Start the site by running `yarn dev`. Note that you'll have to manually remove `/.mdx-data` and `/.next/cache/next-babel-loader` folders every time you add or remove a blog post.

#### Optional
Edit dev script in `package.json` to clean next and mdx cache on every restart:
```json
// package.json
// ...
"scripts": {
    "dev": "rm -rf .next/cache/next-babel-loader .mdx-data && next",
    // ...
  },
// ...
```

Start the site by running `yarn dev`. Navigate to `localhost:3000/blog/post` which should look like this:
![https://p-ZmFjNlQ.b3.n0.cdn.getcloudapp.com/items/WnuEPNzw/Image+2020-01-29+at+10.50.08+AM.png](https://p-ZmFjNlQ.b3.n0.cdn.getcloudapp.com/items/WnuEPNzw/Image+2020-01-29+at+10.50.08+AM.png)


### Create posts index
First, you need to add a babel plugin to detect whether a given import contains a glob pattern. If it does, it will convert the import to individual imports. Read more about it [here](https://github.com/jescalan/babel-plugin-import-glob-array#usage).

1.  `yarn add babel-plugin-import-glob-array`
2. in `package.json`
```json
  "babel": {
    "presets": [
      "next/babel"
    ],
    "plugins": [
      "babel-plugin-import-glob-array"
    ]
  },
```

Display a list of posts on the homepage
```js
// pages/index.js
import Link from 'next/link'
import {frontMatter as posts} from './blog/*.mdx'

export default () => (
  <>
    {posts.map(post => {
      const {title, __resourcePath} = post
      return (
        <Link href={formatPath(__resourcePath)}  key={__resourcePath}>
          <a>{title}</a>
        </Link>
      )
    })}
  </>
)

function formatPath(p) {
  return p.replace(/\.mdx$/, '')
}
```

## You'll need to re-run the server every time you add or remove a post.

---

### Next.js Examples
https://github.com/zeit/next.js/tree/master/examples

